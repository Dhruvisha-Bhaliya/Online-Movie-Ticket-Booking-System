<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core">

    <h:head>
        <title>Admin - Manage Seats</title>

        <style>
            /* Reset and Base Styles */
            body {
                margin: 0;
                padding: 0;
                font-family: "Segoe UI", Roboto, Arial, sans-serif;
                background: #F4F7FB;
                color: #1F2937;
            }

            /* ===== PAGE WRAPPER ===== */
            .page-container {
                padding: 28px;
            }

            .page-title {
                font-size: 26px;
                font-weight: 600;
                margin-bottom: 20px;
                color: #1E3A8A;
            }

            /* ===== CARD ===== */
            .card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 22px;
                margin-bottom: 24px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.06);
            }

            .card-title {
                font-size: 18px;
                font-weight: 600;
                margin-bottom: 20px; /* Increased margin for new layout */
                color: #1E40AF;
            }

            /* ===== FORM LAYOUT (Updated to match Image) ===== */
            /* Container for the fields, using flexbox for two-column structure */
            .form-layout {
                display: flex;
                flex-wrap: wrap; /* Allows wrapping on smaller screens */
                gap: 20px; /* Space between rows */
            }

            /* Styles for each row/grouping (e.g., Screen + Seat Row) */
            .form-row {
                display: flex;
                align-items: center;
                gap: 15px; /* Space between label/input groups in a row */
                flex-grow: 1; /* Allows rows to take available space */
            }

            /* Styles for the individual label/input pair */
            .form-group {
                display: flex;
                flex-direction: column;
                gap: 5px;
                width: 100%;
                /* Ensures inputs take up space properly */
                max-width: 300px;
            }

            label {
                font-weight: 500;
                font-size: 14px;
            }

            input, select {
                width: 100%;
                padding: 8px 10px;
                border-radius: 6px;
                border: 1px solid #CBD5E1;
                font-size: 14px;
                height: 38px;
                box-sizing: border-box;
            }

            input:focus, select:focus {
                outline: none;
                border-color: #2563EB;
            }

            .error {
                color: #DC2626;
                font-size: 12px;
                margin-top: 5px;
            }

            /* ===== FORM BUTTON ACTIONS ===== */
            .form-actions {
                display: flex;
                gap: 12px;
                margin-top: 25px; /* Spacing below the form fields */
                padding-top: 10px;
            }


            /* ===== BUTTONS (Stylish) ===== */
            .btn-primary {
                background: #2563EB;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 8px;
                cursor: pointer;
                font-weight: 500;
                min-width: 130px;
                width: auto;
                transition: background-color 0.2s;
            }

            .btn-primary:hover {
                background: #1D4ED8;
            }

            .btn-secondary {
                /* Less emphasized "Clear" button design */
                background: transparent;
                color: #4B5563;
                border: 1px solid #CBD5E1;
                padding: 10px 20px;
                border-radius: 8px;
                cursor: pointer;
                font-weight: 500;
                min-width: 100px;
                width: auto;
                transition: background-color 0.2s, border-color 0.2s;
            }

            .btn-secondary:hover {
                background: #F3F4F6;
                border-color: #D1D5DB;
            }

            /* ===== TABLE ===== */
            .table-container {
                overflow-x: auto;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 10px;
            }

            thead {
                background: #E0F2FE;
            }

            th {
                padding: 12px;
                text-align: left;
                font-size: 13px;
                font-weight: 600;
                color: #1E3A8A;
                border-bottom: 2px solid #DBEAFE;
            }

            td {
                padding: 12px;
                border-bottom: 1px solid #E5E7EB;
                font-size: 14px;
            }

            tr:hover {
                background: #F8FAFF;
            }

            /* ===== ACTION LINKS (EDIT/DELETE) ===== */
            .action-link {
                color: #2563EB;
                font-weight: 500;
                text-decoration: none;
                margin-right: 15px;
                font-size: 14px;
                transition: color 0.2s;
            }

            .action-link.delete {
                color: #DC2626;
            }

            .action-link:hover {
                text-decoration: underline;
            }


            /* ===== EMPTY TEXT ===== */
            .info-text {
                display: block;
                margin-top: 15px;
                color: #6B7280;
                padding: 5px 0;
                font-style: italic;
            }

            /* ===== RESPONSIVENESS (Mobile First) ===== */
            @media (max-width: 768px) {
                .page-container {
                    padding: 15px;
                }

                .card {
                    padding: 18px;
                }

                .form-layout {
                    flex-direction: column; /* Stack the main rows */
                    gap: 15px;
                }

                .form-row {
                    flex-direction: column; /* Stack the groups within a row */
                    gap: 15px;
                    align-items: flex-start;
                }

                .form-group {
                    max-width: 100%; /* Use full width for inputs */
                }

                .form-actions {
                    flex-direction: column; /* Stack buttons */
                    gap: 10px;
                }

                .btn-primary, .btn-secondary {
                    width: 100%;
                    min-width: auto;
                }
            }
        </style>
    </h:head>

    <h:body>

        <div class="page-container">

            <div class="page-title">Manage Seats</div>

            <div class="card">
                <div class="card-title">
                    #{adminSeatController.editMode ? 'Edit Seat' : 'Add New Seat'}
                </div>

                <h:form id="seatForm">

                    <div class="form-layout">

                        <div class="form-row">
                            <div class="form-group">
                                <h:outputLabel value="Screen" for="screen"/>
                                <h:selectOneMenu id="screen"
                                                 value="#{adminSeatController.selectedScreenId}"
                                                 required="true">
                                    <f:selectItem itemLabel="-- Select Screen --"
                                                  itemValue="#{null}"
                                                  noSelectionOption="true"/>
                                    <f:selectItems value="#{adminSeatController.screenList}"
                                                   var="screen"
                                                   itemLabel="#{screen.screenName} (#{screen.theaterId.theaterName})"
                                                   itemValue="#{screen.screenId}"/>
                                    <f:ajax event="change"
                                            render="seatTable"
                                            listener="#{adminSeatController.updateSeatsForScreen}"/>
                                </h:selectOneMenu>
                                <h:message for="screen" styleClass="error"/>
                            </div>

                            <div class="form-group">
                                <h:outputLabel value="Seat Row" for="seatRow"/>
                                <h:inputText id="seatRow"
                                             value="#{adminSeatController.currentSeat.seatRow}"
                                             maxlength="1"
                                             required="true"/>
                                <h:message for="seatRow" styleClass="error"/>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <h:outputLabel value="Seat Number" for="seatNumber"/>
                                <h:inputText id="seatNumber"
                                             value="#{adminSeatController.currentSeat.seatNumber}"
                                             required="true"/>
                                <h:message for="seatNumber" styleClass="error"/>
                            </div>

                            <div class="form-group">
                                <h:outputLabel value="Status" for="status"/>
                                <h:selectOneMenu id="status"
                                                 value="#{adminSeatController.currentSeat.seatStatus}"
                                                 required="true">
                                    <f:selectItem itemLabel="-- Select Status --"
                                                  itemValue="#{null}"
                                                  noSelectionOption="true"/>
                                    <f:selectItem itemLabel="Available" itemValue="Available"/>
                                    <f:selectItem itemLabel="Booked" itemValue="Booked"/>
                                    <f:selectItem itemLabel="Under Maintenance" itemValue="Under Maintainance"/>
                                </h:selectOneMenu>
                                <h:message for="status" styleClass="error"/>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <h:commandButton value="#{adminSeatController.editMode ? 'Update Seat' : 'Add Seat'}"
                                         action="#{adminSeatController.saveSeat}"
                                         styleClass="btn-primary"/>

                        <h:commandButton value="Clear"
                                         action="#{adminSeatController.resetForm}"
                                         immediate="true"
                                         styleClass="btn-secondary">
                            <f:ajax render="@form :seatTable"/>
                        </h:commandButton>
                    </div>
                </h:form>
            </div>

            <div class="card">
                <div class="card-title">Seats per Screen</div>

                <h:form id="seatTable">
                    <div class="table-container">

                        <h:dataTable value="#{adminSeatController.seatsForSelectedScreen}"
                                     var="seat"
                                     rendered="#{not empty adminSeatController.seatsForSelectedScreen}">

                            <h:column><f:facet name="header">ID</f:facet>#{seat.seatId}</h:column>
                            <h:column><f:facet name="header">Screen</f:facet>#{seat.screenId.screenName}</h:column>
                            <h:column><f:facet name="header">Row</f:facet>#{seat.seatRow}</h:column>
                            <h:column><f:facet name="header">Number</f:facet>#{seat.seatNumber}</h:column>
                            <h:column><f:facet name="header">Status</f:facet>#{seat.seatStatus}</h:column>

                            <h:column>
                                <f:facet name="header">Actions</f:facet>

                                <h:commandLink value="Edit"
                                               action="#{adminSeatController.editSeat(seat)}"
                                               styleClass="action-link">
                                    <!-- Refresh both the form and table -->
                                    <f:ajax render=":seatForm :seatTable"/>
                                </h:commandLink>

                                <h:commandLink value="Delete"
                                               action="#{adminSeatController.deleteSeat(seat)}"
                                               styleClass="action-link delete"
                                               onclick="return confirm('Are you sure you want to delete this seat?');">
                                    <f:ajax render=":seatTable"/>
                                </h:commandLink>
                            </h:column>

                        </h:dataTable>

                        <h:outputText value="Please select a screen to view seats."
                                      rendered="#{empty adminSeatController.seatsForSelectedScreen and adminSeatController.selectedScreenId == null}"
                                      styleClass="info-text"/>

                        <h:outputText value="No seats found for this screen."
                                      rendered="#{empty adminSeatController.seatsForSelectedScreen and adminSeatController.selectedScreenId != null}"
                                      styleClass="info-text"/>

                    </div>
                </h:form>
            </div>

        </div>

    </h:body>
</html>