<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets">

    <ui:composition template="/WEB-INF/templates/adminlayout.xhtml">

        <ui:define name="title">Superadmin Dashboard</ui:define>

        <ui:define name="content">

            <!-- PAGE TITLE -->
            <h2 class="page-title">Manage Admin Users</h2>

            <!-- ADD USER BUTTON -->
            <button class="btn-primary" onclick="openModal()">+ Add User</button>

            <!-- ================= USER LIST ================= -->
            <h:form id="userListForm">
                <h:dataTable value="#{manageUserBean.allAdmins}" var="u" styleClass="table">

                    <h:column>
                        <f:facet name="header">Name</f:facet>
                            #{u.username}
                    </h:column>

                    <h:column>
                        <f:facet name="header">Email</f:facet>
                            #{u.email}
                    </h:column>

                    <h:column>
                        <f:facet name="header">Phone</f:facet>
                            #{u.phoneno}
                    </h:column>

                    <h:column>
                        <f:facet name="header">Role</f:facet>
                            #{u.role.role}
                    </h:column>

                    <h:column>
                        <f:facet name="header">Actions</f:facet>

                        <h:commandLink value="âœ Edit"
                                       action="#{manageUserBean.edit(u)}"
                                       styleClass="btn-edit"/>

                        <h:commandLink value="ðŸ—‘ Delete"
                                       action="#{manageUserBean.delete(u.userId)}"
                                       onclick="return confirm('Are you sure?')"
                                       styleClass="btn-delete"/>
                    </h:column>

                </h:dataTable>
            </h:form>

            <!-- ================= ADD USER MODAL ================= -->
            <div id="modal" class="modal">
                <div class="modal-box">

                    <span class="close" onclick="closeModal()">Ã—</span>

                    <h2 class="modal-title">Create New User</h2>

                    <h:form id="createUserForm" styleClass="form-container">

                        <div class="form-group">
                            <label>Full Name</label>
                            <h:inputText value="#{manageUserBean.username}" required="true"
                                         styleClass="input" />
                        </div>

                        <div class="form-group">
                            <label>Email Address</label>
                            <h:inputText value="#{manageUserBean.email}" required="true"
                                         styleClass="input" />
                        </div>

                        <div class="form-group">
                            <label>Phone Number</label>
                            <h:inputText value="#{manageUserBean.phone}" required="true"
                                         styleClass="input" />
                        </div>

                        <div class="form-group">
                            <label>Password</label>
                            <h:inputSecret value="#{manageUserBean.password}" required="true"
                                           styleClass="input" />
                        </div>

                        <div class="form-group">
                            <label>Select Role</label>
                            <h:selectOneMenu value="#{manageUserBean.roleId}" styleClass="input">
                                <f:selectItems value="#{manageUserBean.allRoles}" var="r"
                                               itemLabel="#{r.role}" itemValue="#{r.roleId}" />
                            </h:selectOneMenu>
                        </div>

                        <h:commandButton value="Create User"
                                         action="#{manageUserBean.createUser}"
                                         styleClass="btn-primary full-btn"/>

                    </h:form>

                </div>
            </div>
            <!-- ================= CSS ================= -->
            <style>
                .page-title {
                    font-size: 24px;
                    margin-bottom: 15px;
                    color: #222;
                    font-weight: 600;
                }

                .btn-primary {
                    padding: 10px 18px;
                    background: #4e73df;
                    color: white;
                    border: none;
                    border-radius: 6px;
                    cursor: pointer;
                    margin-bottom: 15px;
                    transition: 0.3s ease;
                    box-shadow: 0 3px 6px rgba(0,0,0,0.2);
                }
                .btn-primary:hover {
                    background: #2e59d9;
                }

                .table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-top: 20px;
                    box-shadow: 0px 2px 8px rgba(0,0,0,0.1);
                }
                .table th, .table td {
                    padding: 12px;
                    border-bottom: 1px solid #eee;
                }
                .table th {
                    background: #f7f7f7;
                    font-weight: 600;
                }

                .btn-edit {
                    margin-right: 8px;
                    color: #1cc88a;
                    font-weight: bold;
                }
                .btn-delete {
                    color: #e74a3b;
                    font-weight: bold;
                }

                /* MODAL DESIGN */
                .modal {
                    display: none;
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.6);
                    justify-content: center;
                    align-items: center;
                }
                .modal-content {
                    background: white;
                    padding: 20px;
                    width: 400px;
                    border-radius: 8px;
                    box-shadow: 0px 4px 12px rgba(0,0,0,0.25);
                    position: relative;
                }
                .close {
                    position: absolute;
                    top: 10px;
                    right: 15px;
                    font-size: 22px;
                    cursor: pointer;
                    font-weight: bold;
                }

                .form-group {
                    margin-bottom: 12px;
                    display: flex;
                    flex-direction: column;
                }
                .form-group label {
                    margin-bottom: 3px;
                    font-weight: 500;
                }
            </style>

            <!-- ================= JS ================= -->
            <script>
                function openModal() {
                    document.getElementById("modal").style.display = "flex";
                }
                function closeModal() {
                    document.getElementById("modal").style.display = "none";
                }
            </script>

        </ui:define>

    </ui:composition>

</html>
